<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Standardize data — hbl_data • historicalborrowlong</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Standardize data — hbl_data"><meta property="og:description" content="Standardize a tidy input dataset."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">historicalborrowlong</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/methods.html">Methods</a>
    </li>
    <li>
      <a href="../articles/usage.html">Usage</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/wlandau/historicalborrowlong/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Standardize data</h1>
    <small class="dont-index">Source: <a href="https://github.com/wlandau/historicalborrowlong/blob/HEAD/R/hbl_data.R" class="external-link"><code>R/hbl_data.R</code></a></small>
    <div class="hidden name"><code>hbl_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Standardize a tidy input dataset.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hbl_data</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">response</span>,</span>
<span>  <span class="va">study</span>,</span>
<span>  <span class="va">study_reference</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">group_reference</span>,</span>
<span>  <span class="va">patient</span>,</span>
<span>  <span class="va">rep</span>,</span>
<span>  <span class="va">rep_reference</span>,</span>
<span>  <span class="va">covariates</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A tidy data frame or <code>tibble</code> with the data.</p></dd>


<dt>response</dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p></dd>


<dt>study</dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p></dd>


<dt>study_reference</dt>
<dd><p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p></dd>


<dt>group</dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p></dd>


<dt>group_reference</dt>
<dd><p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p></dd>


<dt>patient</dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p></dd>


<dt>rep</dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the rep ID.</p></dd>


<dt>rep_reference</dt>
<dd><p>Atomic of length 1,
element of the <code>rep</code> column that indicates
baseline, i.e. the first rep chronologically.
(The other reps may be post-baseline study visits or time points.)</p></dd>


<dt>covariates</dt>
<dd><p>Character vector of column names
in <code>data</code> with the columns with baseline covariates.
These can be continuous, categorical, or binary.
Regardless, <code>historicalborrowlong</code> derives the appropriate
model matrix.</p>
<p>Each baseline covariate column must truly be a <em>baseline</em> covariate:
elements must be equal for all time points within each patient
(after the steps in the "Data processing" section).
In other words, covariates must not be time-varying.</p>
<p>A large number of covariates, or a large number of levels in a
categorical covariate, can severely slow down the computation.
Please consider carefully if you really need to include
such complicated baseline covariates.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A standardized tidy data frame with one row per patient
and the following columns:</p><ul><li><p><code>response</code>: continuous response/outcome variable. (Should be
change from baseline of an outcome of interest.)</p></li>
<li><p><code>study_label</code>: human-readable label of the study.</p></li>
<li><p><code>study</code>: integer study index with the max index equal to the
current study (at <code>study_reference</code>).</p></li>
<li><p><code>group_label</code>: human-readable group label (e.g. treatment arm name).</p></li>
<li><p><code>group</code>: integer group index with an index of 1 equal to the control
group (at <code>group_reference</code>).</p></li>
<li><p><code>patient_label</code>: original patient ID.</p></li>
<li><p><code>patient</code>: integer patient index.</p></li>
<li><p><code>rep_label</code>: original rep ID (e.g. time point or patient visit).</p></li>
<li><p><code>rep</code>: integer rep index.</p></li>
<li><p><code>covariate_*</code>: baseline covariate columns.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Users do not normally need to call this function.
It mainly serves exposes the indexing behavior of
studies and group levels to aid in interpreting
summary tables.</p>
    </div>
    <div id="data-processing">
    <h2>Data processing</h2>
    

<p>Before running the MCMC, dataset is pre-processed.
This includes expanding the rows of the data so every rep
of every patient gets an explicit row. So if your
original data has irregular rep IDs, e.g. unscheduled
visits in a clinical trial that few patients attend,
please remove them before the analysis. Only the most
common rep IDs should be added.</p>
<p>After expanding the rows, the function fills in missing
values for every column except the response. That includes
covariates. Missing covariate values are filled in,
first with last observation carried forward,
then with last observation carried backward.
If there are still missing values after this process,
the program throws an informative error.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other data: 
<code><a href="hbl_s_tau.html">hbl_s_tau</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="hbl_sim_independent.html">hbl_sim_independent</a></span><span class="op">(</span>n_continuous <span class="op">=</span> <span class="fl">1</span>, n_study <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span>,</span></span>
<span class="r-in"><span>  <span class="va">study</span>,</span></span>
<span class="r-in"><span>  <span class="va">group</span>,</span></span>
<span class="r-in"><span>  <span class="va">rep</span>,</span></span>
<span class="r-in"><span>  <span class="va">patient</span>,</span></span>
<span class="r-in"><span>  <span class="va">response</span>,</span></span>
<span class="r-in"><span>  <span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span>,</span></span>
<span class="r-in"><span>  change <span class="op">=</span> <span class="va">response</span>,</span></span>
<span class="r-in"><span>  trial <span class="op">=</span> <span class="va">study</span>,</span></span>
<span class="r-in"><span>  arm <span class="op">=</span> <span class="va">group</span>,</span></span>
<span class="r-in"><span>  subject <span class="op">=</span> <span class="va">patient</span>,</span></span>
<span class="r-in"><span>  visit <span class="op">=</span> <span class="va">rep</span>,</span></span>
<span class="r-in"><span>  cov1 <span class="op">=</span> <span class="va">covariate_study1_continuous1</span>,</span></span>
<span class="r-in"><span>  cov2 <span class="op">=</span> <span class="va">covariate_study2_continuous1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"trial"</span>, <span class="va">data</span><span class="op">$</span><span class="va">trial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">arm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"arm"</span>, <span class="va">data</span><span class="op">$</span><span class="va">arm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"subject"</span>, <span class="va">data</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"visit"</span>, <span class="va">data</span><span class="op">$</span><span class="va">visit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hbl_data</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  response <span class="op">=</span> <span class="st">"change"</span>,</span></span>
<span class="r-in"><span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span></span>
<span class="r-in"><span>  study_reference <span class="op">=</span> <span class="st">"trial1"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span></span>
<span class="r-in"><span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span></span>
<span class="r-in"><span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span></span>
<span class="r-in"><span>  rep <span class="op">=</span> <span class="st">"visit"</span>,</span></span>
<span class="r-in"><span>  rep_reference <span class="op">=</span> <span class="st">"visit1"</span>,</span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cov1"</span>, <span class="st">"cov2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,600 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    study patient patient_l…¹   rep rep_l…² respo…³ study…⁴ group…⁵ group covar…⁶</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1       4 subject101      1 visit1    0.753 trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     1       4 subject101      2 visit2   -<span style="color: #BB0000;">1.43</span>  trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     1       4 subject101      3 visit3   -<span style="color: #BB0000;">2.02</span>  trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     1       4 subject101      4 visit4    0.644 trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     1       5 subject102      1 visit1    1.38  trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     1       5 subject102      2 visit2   -<span style="color: #BB0000;">2.63</span>  trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     1       5 subject102      3 visit3    0.865 trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     1       5 subject102      4 visit4    0.262 trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     1       6 subject103      1 visit1   -<span style="color: #BB0000;">0.791</span> trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     1       6 subject103      2 visit2   -<span style="color: #BB0000;">2.09</span>  trial2  arm1        1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 1,590 more rows, 1 more variable: covariate_cov2 &lt;dbl&gt;, and</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   abbreviated variable names ¹​patient_label, ²​rep_label, ³​response,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ⁴​study_label, ⁵​group_label, ⁶​covariate_cov1</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by William Michael Landau.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

