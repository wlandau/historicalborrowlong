<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Usage • historicalborrowlong</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Usage">
<meta property="og:description" content="historicalborrowlong">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">historicalborrowlong</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/methods.html">Methods</a>
    </li>
    <li>
      <a href="../articles/usage.html">Usage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wlandau/historicalborrowlong/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/wlandau/historicalborrowlong/blob/HEAD/vignettes/usage.Rmd" class="external-link"><code>vignettes/usage.Rmd</code></a></small>
      <div class="hidden name"><code>usage.Rmd</code></div>

    </div>

    
    
<p>This usage tutorial shows how to fit historical control-group
borrowing models using the <code>historicalborrowlong</code>
package.</p>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p><code>historicalborrowlong</code> expects data on multiple patients
partitioned into studies, groups, and repeated measures (“reps”). Here
is a simulated example. There are functions to simulate from the prior
predictive distribution of each of the hierarchical, independent, and
pooled models.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wlandau.github.io/historicalborrowlong/" class="external-link">historicalborrowlong</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbl_sim_independent.html">hbl_sim_independent</a></span><span class="op">(</span></span>
<span>  n_continuous <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_study <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_group <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n_rep <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  n_patient <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    outcome <span class="op">=</span> <span class="va">response</span>,</span>
<span>    trial <span class="op">=</span> <span class="va">study</span>,</span>
<span>    arm <span class="op">=</span> <span class="va">group</span>,</span>
<span>    subject <span class="op">=</span> <span class="va">patient</span>,</span>
<span>    visit <span class="op">=</span> <span class="va">rep</span>,</span>
<span>    factor1 <span class="op">=</span> <span class="va">covariate_study1_continuous1</span>,</span>
<span>    factor2 <span class="op">=</span> <span class="va">covariate_study2_continuous1</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"trial"</span>, <span class="va">trial</span><span class="op">)</span>,</span>
<span>    arm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"arm"</span>, <span class="va">arm</span><span class="op">)</span>,</span>
<span>    subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"subject"</span>, <span class="va">subject</span><span class="op">)</span>,</span>
<span>    visit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"visit"</span>, <span class="va">visit</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 160 × 8</span></span></span>
<span><span class="co">#&gt;    trial  arm   subject  visit  factor1 factor2 covariate_study3_conti…¹ outcome</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> trial1 arm1  subject1 visit1   0.764       0                        0  2.82  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> trial1 arm1  subject1 visit2   0.764       0                        0  3.40  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> trial1 arm1  subject1 visit3   0.764       0                        0  3.30  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> trial1 arm1  subject1 visit4   0.764       0                        0  3.02  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> trial1 arm1  subject2 visit1  -<span style="color: #BB0000;">0.799</span>       0                        0 -<span style="color: #BB0000;">0.504</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> trial1 arm1  subject2 visit2  -<span style="color: #BB0000;">0.799</span>       0                        0  0.095<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> trial1 arm1  subject2 visit3  -<span style="color: #BB0000;">0.799</span>       0                        0  0.441 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> trial1 arm1  subject2 visit4  -<span style="color: #BB0000;">0.799</span>       0                        0 -<span style="color: #BB0000;">0.092</span><span style="color: #BB0000; text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> trial1 arm1  subject3 visit1  -<span style="color: #BB0000;">1.15</span>        0                        0 -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> trial1 arm1  subject3 visit2  -<span style="color: #BB0000;">1.15</span>        0                        0 -<span style="color: #BB0000;">1.13</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 150 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​covariate_study3_continuous1</span></span></span></code></pre></div>
<p>You as the user will choose a reference level of the
<code>study</code> (“trial”) column to indicate which study is the
current one (the other are historical). Likewise, you will choose a
level of the <code>group</code> (“arm”) column to indicate which group
is the control group and a level of the <code>rep</code> (“visit”)
column to indicate the first measurement of each patient (baseline). To
see how <code>historicalborrowlong</code> assigns numeric indexes to the
study and group levels, use <code><a href="../reference/hbl_data.html">hbl_data()</a></code>. Viewing this output
may assist with interpreting the results later on.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standardized_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbl_data.html">hbl_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  rep <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  rep_reference <span class="op">=</span> <span class="st">"visit1"</span>,</span>
<span>   <span class="co"># Can be continuous, categorical, or binary columns:</span></span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">standardized_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 160 × 11</span></span></span>
<span><span class="co">#&gt;    study patient patient_label   rep rep_label response study_label group_label</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       1 subject1          1 visit1      2.82   trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1       1 subject1          2 visit2      3.40   trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1       1 subject1          3 visit3      3.30   trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1       1 subject1          4 visit4      3.02   trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1       2 subject10         1 visit1      0.343  trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1       2 subject10         2 visit2     -<span style="color: #BB0000;">1.46</span>   trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1       2 subject10         3 visit3     -<span style="color: #BB0000;">0.747</span>  trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1       2 subject10         4 visit4      0.155  trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1      12 subject2          1 visit1     -<span style="color: #BB0000;">0.504</span>  trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1      12 subject2          2 visit2      0.095<span style="text-decoration: underline;">2</span> trial1      arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 150 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: group &lt;int&gt;, covariate_factor1 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   covariate_factor2 &lt;dbl&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span></span>
<span>  <span class="va">standardized_data</span>,</span>
<span>  <span class="va">study</span>,</span>
<span>  <span class="va">study_label</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">group_label</span>,</span>
<span>  <span class="va">rep</span>,</span>
<span>  <span class="va">rep_label</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">study</span>,</span>
<span>    <span class="va">study_label</span>,</span>
<span>    <span class="va">group</span>,</span>
<span>    <span class="va">group_label</span>,</span>
<span>    <span class="va">rep</span>,</span>
<span>    <span class="va">rep_label</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 6</span></span></span>
<span><span class="co">#&gt;    study study_label group group_label   rep rep_label</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 trial1          1 arm1            1 visit1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 trial1          1 arm1            2 visit2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1 trial1          1 arm1            3 visit3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1 trial1          1 arm1            4 visit4   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     2 trial2          1 arm1            1 visit1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     2 trial2          1 arm1            2 visit2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     2 trial2          1 arm1            3 visit3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2 trial2          1 arm1            4 visit4   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     3 trial3          1 arm1            1 visit1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     3 trial3          1 arm1            2 visit2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     3 trial3          1 arm1            3 visit3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>     3 trial3          1 arm1            4 visit4   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>     3 trial3          2 arm2            1 visit1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>     3 trial3          2 arm2            2 visit2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>     3 trial3          2 arm2            3 visit3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>     3 trial3          2 arm2            4 visit4</span></span></code></pre></div>
<p>As explained in the <code><a href="../reference/hbl_data.html">hbl_data()</a></code> and
<code>hb_mcmc_*()</code> help files, before running the MCMC, dataset is
pre-processed. This includes expanding the rows of the data so every rep
of every patient gets an explicit row. So if your original data has
irregular rep IDs, e.g. unscheduled visits in a clinical trial that few
patients attend, please remove them before the analysis. Only the most
common rep IDs should be added.</p>
<p>After expanding the rows, the function fills in missing values for
every column except the response. That includes covariates. Missing
covariate values are filled in, first with last observation carried
forward, then with last observation carried backward. If there are still
missing values after this process, the program throws an informative
error.</p>
</div>
<div class="section level2">
<h2 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h2>
<div class="section level3">
<h3 id="recommended-run-all-models-using-hbl_mcmc_sge">Recommended: run all models using <code>hbl_mcmc_sge()</code><a class="anchor" aria-label="anchor" href="#recommended-run-all-models-using-hbl_mcmc_sge"></a>
</h3>
<p>The <code><a href="../reference/hbl_mcmc_sge.html">hbl_mcmc_sge()</a></code> function runs all 3 models of
interest on a Sun Grid Engine (SGE) computing cluster and returns a list
of results from all three models. For standardized analyses of real
studies, this is highly recommended over the alternative of running each
model separately (<code><a href="../reference/hbl_mcmc_hierarchical.html">hbl_mcmc_hierarchical()</a></code>,
<code><a href="../reference/hbl_mcmc_pool.html">hbl_mcmc_pool()</a></code>, and <code><a href="../reference/hbl_mcmc_independent.html">hbl_mcmc_independent()</a></code>,
as in the next subsection).</p>
<p>In <code><a href="../reference/hbl_mcmc_sge.html">hbl_mcmc_sge()</a></code>, each model runs in its own SGE job,
and chains run in parallel across the cores available to each job. The
return value is a list of results from each model (hierarchical,
independent, and pooled) that you would get by running
<code><a href="../reference/hbl_mcmc_hierarchical.html">hbl_mcmc_hierarchical()</a></code>, <code><a href="../reference/hbl_mcmc_pool.html">hbl_mcmc_pool()</a></code>, and
<code><a href="../reference/hbl_mcmc_independent.html">hbl_mcmc_independent()</a></code> separately. Each of these data
frames each be supplied separately to <code><a href="../reference/hbl_summary.html">hbl_summary()</a></code> as
explained later in this vignette.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbl_mcmc_sge.html">hbl_mcmc_sge</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  rep <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  rep_reference <span class="op">=</span> <span class="st">"visit1"</span>,</span>
<span>   <span class="co"># Can be continuous, categorical, or binary columns:</span></span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Raise these arguments for serious analyses:</span></span>
<span>  chains <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Increase to about 3 or 4 in real-life use cases.</span></span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>, <span class="co"># *HIGHLY* recommended to have cores = chains</span></span>
<span>  iter <span class="op">=</span> <span class="fl">20</span>, <span class="co"># Increase to several thousand in real-life use cases.</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">10</span>, <span class="co"># Increase to several thousand in real-life use cases.</span></span>
<span>  log <span class="op">=</span> <span class="st">"/dev/null"</span>, <span class="co"># optional SGE log file, /dev/null to disregard the log</span></span>
<span>  scheduler <span class="op">=</span> <span class="st">"local"</span> <span class="co"># Set to "sge" for serious analysis.</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'historicalborrowlong' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.000103 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.03 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: WARNING: No variance estimation is</span></span>
<span><span class="co">#&gt; Chain 1:          performed for num_warmup &lt; 20</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  1 / 20 [  5%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  2 / 20 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  4 / 20 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  6 / 20 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  8 / 20 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 10 / 20 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 11 / 20 [ 55%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 12 / 20 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 14 / 20 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 16 / 20 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 18 / 20 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 20 / 20 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 0.052 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                0.462 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                0.514 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'historicalborrowlong' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 7e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.7 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: WARNING: No variance estimation is</span></span>
<span><span class="co">#&gt; Chain 1:          performed for num_warmup &lt; 20</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  1 / 20 [  5%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  2 / 20 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  4 / 20 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  6 / 20 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  8 / 20 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 10 / 20 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 11 / 20 [ 55%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 12 / 20 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 14 / 20 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 16 / 20 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 18 / 20 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 20 / 20 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 0.069 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                0.08 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                0.149 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'historicalborrowlong' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 6.6e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.66 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: WARNING: No variance estimation is</span></span>
<span><span class="co">#&gt; Chain 1:          performed for num_warmup &lt; 20</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  1 / 20 [  5%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  2 / 20 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  4 / 20 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  6 / 20 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  8 / 20 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 10 / 20 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 11 / 20 [ 55%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 12 / 20 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 14 / 20 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 16 / 20 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 18 / 20 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 20 / 20 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 0.054 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                0.059 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                0.113 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1:</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc</span></span>
<span><span class="co">#&gt; $hierarchical</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 69</span></span></span>
<span><span class="co">#&gt;    `alpha[1]` `alpha[2]` `alpha[3]` `alpha[4]` `alpha[5]` `alpha[6]` `alpha[7]`</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      2.37       1.32       0.679      1.42       3.06      -<span style="color: #BB0000;">0.732</span>      0.187</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      0.778      1.75       1.28       0.870      0.748      0.603      1.30 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      0.770      1.14       1.02       0.866      0.722      0.655      1.02 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1.04       1.58       1.18       1.23       0.945      1.08       1.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      0.566      2.07       1.10       0.506      0.497      0.911      1.10 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      0.521      1.61       1.00       0.896      0.431      0.970      1.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      0.810      1.14       1.08       0.724      0.868      0.986      1.09 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      1.03       0.963      1.03       0.752      0.619      0.966      0.529</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      1.27       0.857      0.930      0.752      0.657      1.01       1.22 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      0.560      1.75       0.975      0.256      0.604      0.980      0.634</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 62 more variables: `alpha[8]` &lt;dbl&gt;, `alpha[9]` &lt;dbl&gt;, `alpha[10]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `alpha[11]` &lt;dbl&gt;, `alpha[12]` &lt;dbl&gt;, `delta[1]` &lt;dbl&gt;, `delta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `delta[3]` &lt;dbl&gt;, `delta[4]` &lt;dbl&gt;, `beta[1]` &lt;dbl&gt;, `beta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,1]` &lt;dbl&gt;, `sigma[2,1]` &lt;dbl&gt;, `sigma[3,1]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,2]` &lt;dbl&gt;, `sigma[2,2]` &lt;dbl&gt;, `sigma[3,2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,3]` &lt;dbl&gt;, `sigma[2,3]` &lt;dbl&gt;, `sigma[3,3]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,4]` &lt;dbl&gt;, `sigma[2,4]` &lt;dbl&gt;, `sigma[3,4]` &lt;dbl&gt;, …</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $independent</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 61</span></span></span>
<span><span class="co">#&gt;    `alpha[1]` `alpha[2]` `alpha[3]` `alpha[4]` `alpha[5]` `alpha[6]` `alpha[7]`</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1.00       1.45       1.01       0.902      0.408     -<span style="color: #BB0000;">1.74</span>        1.10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1.37       0.852      0.948      0.839      0.923     -<span style="color: #BB0000;">0.784</span>       1.70</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      0.913      0.914      1.07       1.20       0.284      0.935       1.26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      0.868      0.969      1.02       1.48       0.661      0.986       2.32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      1.05       1.01       1.03       1.52       0.264      0.992       2.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      0.501      1.04       1.05       0.808      1.05       0.994       2.10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      0.965      1.16       1.00       0.559     -<span style="color: #BB0000;">0.256</span>      0.998       1.31</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      0.830      1.10       1.02       0.612     -<span style="color: #BB0000;">0.457</span>      1.01        1.35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      1.49       0.927      0.891      0.522      1.24       0.981       1.07</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      1.18       0.840      0.972      0.894      0.982      0.979       1.25</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 54 more variables: `alpha[8]` &lt;dbl&gt;, `alpha[9]` &lt;dbl&gt;, `alpha[10]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `alpha[11]` &lt;dbl&gt;, `alpha[12]` &lt;dbl&gt;, `delta[1]` &lt;dbl&gt;, `delta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `delta[3]` &lt;dbl&gt;, `delta[4]` &lt;dbl&gt;, `beta[1]` &lt;dbl&gt;, `beta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,1]` &lt;dbl&gt;, `sigma[2,1]` &lt;dbl&gt;, `sigma[3,1]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,2]` &lt;dbl&gt;, `sigma[2,2]` &lt;dbl&gt;, `sigma[3,2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,3]` &lt;dbl&gt;, `sigma[2,3]` &lt;dbl&gt;, `sigma[3,3]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,4]` &lt;dbl&gt;, `sigma[2,4]` &lt;dbl&gt;, `sigma[3,4]` &lt;dbl&gt;, lp__ &lt;dbl&gt;, …</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pool</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 53</span></span></span>
<span><span class="co">#&gt;    `alpha[1]` `alpha[2]` `alpha[3]` `alpha[4]` `delta[1]` `delta[2]` `delta[3]`</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1.02       0.942      1.01       1.06     -<span style="color: #BB0000;">0.797</span>     -<span style="color: #BB0000;">0.276</span>   -<span style="color: #BB0000;">0.665</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      0.941      1.02       1.04       0.927     0.528      0.015<span style="text-decoration: underline;">1</span>   0.263   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      1.07       0.839      0.998      0.854    -<span style="color: #BB0000;">0.311</span>      0.310    0.187   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      0.741      1.17       1.04       1.00     -<span style="color: #BB0000;">0.022</span><span style="color: #BB0000; text-decoration: underline;">3</span>    -<span style="color: #BB0000;">0.102</span>   -<span style="color: #BB0000;">0.272</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      0.994      1.04       1.04       0.964    -<span style="color: #BB0000;">0.010</span><span style="color: #BB0000; text-decoration: underline;">3</span>     0.275   -<span style="color: #BB0000;">0.165</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      0.954      1.06       0.984      0.951    -<span style="color: #BB0000;">0.493</span>      0.765    0.278   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      1.02       0.958      1.02       0.874     0.207      0.681    0.453   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      0.974      0.962      1.02       0.908    -<span style="color: #BB0000;">0.192</span>      0.322    0.015<span style="text-decoration: underline;">8</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      0.867      0.955      0.873      1.03     -<span style="color: #BB0000;">0.035</span><span style="color: #BB0000; text-decoration: underline;">6</span>     0.023<span style="text-decoration: underline;">0</span>  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">104</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      0.936      0.970      0.969      1.01     -<span style="color: #BB0000;">0.731</span>      0.170   -<span style="color: #BB0000;">0.384</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more variables: `delta[4]` &lt;dbl&gt;, `beta[1]` &lt;dbl&gt;, `beta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,1]` &lt;dbl&gt;, `sigma[2,1]` &lt;dbl&gt;, `sigma[3,1]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,2]` &lt;dbl&gt;, `sigma[2,2]` &lt;dbl&gt;, `sigma[3,2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,3]` &lt;dbl&gt;, `sigma[2,3]` &lt;dbl&gt;, `sigma[3,3]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,4]` &lt;dbl&gt;, `sigma[2,4]` &lt;dbl&gt;, `sigma[3,4]` &lt;dbl&gt;, lp__ &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   .chain &lt;int&gt;, .iteration &lt;int&gt;, .draw &lt;int&gt;, `lambda_current[1,2,1]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `lambda_current[1,3,1]` &lt;dbl&gt;, `lambda_current[1,4,1]` &lt;dbl&gt;, …</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="alternative-run-specific-models">Alternative: run specific models<a class="anchor" aria-label="anchor" href="#alternative-run-specific-models"></a>
</h3>
<p>The hierarchical model is the primary model of interest.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_hierarchical</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbl_mcmc_hierarchical.html">hbl_mcmc_hierarchical</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  rep <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  rep_reference <span class="op">=</span> <span class="st">"visit1"</span>,</span>
<span>  <span class="co"># Can be continuous, categorical, or binary columns.</span></span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Raise these arguments for serious analyses:</span></span>
<span>  chains <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Increase to about 3 or 4 in real-life use cases.</span></span>
<span>  iter <span class="op">=</span> <span class="fl">400</span>, <span class="co"># Increase to several thousand in real-life use cases.</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">200</span>, <span class="co"># Increase to several thousand in real-life use cases.</span></span>
<span>  cores <span class="op">=</span> <span class="fl">1</span> <span class="co"># Optionally run different chains in different processes.</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'historicalborrowlong' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 7.2e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.72 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 400 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  40 / 400 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  80 / 400 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 120 / 400 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 160 / 400 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 400 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 201 / 400 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 240 / 400 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 280 / 400 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 320 / 400 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 360 / 400 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 400 / 400 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 8.99 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                9.457 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                18.447 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1:</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_hierarchical</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 200 × 69</span></span></span>
<span><span class="co">#&gt;    `alpha[1]` `alpha[2]` `alpha[3]` `alpha[4]` `alpha[5]` `alpha[6]` `alpha[7]`</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      0.867      1.00       1.05       0.813      0.571      0.984      0.927</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1.15       1.01       0.982      0.783      0.481      0.990      0.982</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      0.824      1.13       1.01       0.535      0.609      0.975      1.03 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1.30       0.923      0.984      0.979      0.252      0.978      1.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      0.956      0.902      0.953      0.878      1.13       0.957      0.898</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      1.36       0.892      0.924      0.856      0.542      0.990      1.73 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      0.676      1.12       1.01       0.498      0.301      0.973      0.897</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      1.18       0.875      0.929      1.02       0.531      0.996      1.07 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      1.20       0.844      1.00       0.393      0.569      0.994      1.20 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      0.942      1.01       1.06       0.954      0.462      0.984      0.977</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 190 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 62 more variables: `alpha[8]` &lt;dbl&gt;, `alpha[9]` &lt;dbl&gt;, `alpha[10]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `alpha[11]` &lt;dbl&gt;, `alpha[12]` &lt;dbl&gt;, `delta[1]` &lt;dbl&gt;, `delta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `delta[3]` &lt;dbl&gt;, `delta[4]` &lt;dbl&gt;, `beta[1]` &lt;dbl&gt;, `beta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,1]` &lt;dbl&gt;, `sigma[2,1]` &lt;dbl&gt;, `sigma[3,1]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,2]` &lt;dbl&gt;, `sigma[2,2]` &lt;dbl&gt;, `sigma[3,2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,3]` &lt;dbl&gt;, `sigma[2,3]` &lt;dbl&gt;, `sigma[3,3]` &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p>The pooled and independent models are benchmarks used to quantify the
borrowing strength of the hierarchical model. To run these benchmark
models, run the functions below. Each function returns a data frame with
one column per parameter and one row per posterior sample.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_pool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbl_mcmc_pool.html">hbl_mcmc_pool</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  rep <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  rep_reference <span class="op">=</span> <span class="st">"visit1"</span>,</span>
<span>  <span class="co"># Can be continuous, categorical, or binary columns:</span></span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Raise these arguments for serious analyses:</span></span>
<span>  chains <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Increase to about 3 or 4 in real-life use cases.</span></span>
<span>  iter <span class="op">=</span> <span class="fl">400</span>, <span class="co"># Increase to several thousand in real-life use cases.</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">200</span>, <span class="co"># Increase to several thousand in real-life use cases.</span></span>
<span>  cores <span class="op">=</span> <span class="fl">1</span> <span class="co"># Optionally run different chains in different processes.</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'historicalborrowlong' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 6.2e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.62 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 400 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  40 / 400 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  80 / 400 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 120 / 400 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 160 / 400 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 400 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 201 / 400 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 240 / 400 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 280 / 400 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 320 / 400 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 360 / 400 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 400 / 400 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 2.449 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                0.829 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                3.278 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1:</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_pool</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 200 × 53</span></span></span>
<span><span class="co">#&gt;    `alpha[1]` `alpha[2]` `alpha[3]` `alpha[4]` `delta[1]` `delta[2]` `delta[3]`</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1.10       1.00       1.02       0.961     0.057<span style="text-decoration: underline;">4</span>    -<span style="color: #BB0000;">0.081</span><span style="color: #BB0000; text-decoration: underline;">3</span>     0.127 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      0.971      1.01       0.982      1.02     -<span style="color: #BB0000;">0.205</span>      0.629      0.172 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      0.947      0.982      1.06       0.992     0.422      0.125      0.243 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      0.892      0.976      1.01       0.887    -<span style="color: #BB0000;">0.293</span>      0.413      0.065<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      0.794      0.974      0.972      0.860    -<span style="color: #BB0000;">0.250</span>      0.115      0.017<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      1.13       0.981      0.993      0.985     0.900      1.38       0.952 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      0.853      0.993      0.984      0.877     1.11       0.989      1.10  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      1.13       0.970      0.968      1.13      0.033<span style="text-decoration: underline;">8</span>    -<span style="color: #BB0000;">0.187</span>      0.017<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      1.03       0.976      1.03       1.01     -<span style="color: #BB0000;">0.090</span><span style="color: #BB0000; text-decoration: underline;">3</span>     0.327      0.140 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      0.987      0.984      0.998      0.996     0.237      0.581      0.282 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 190 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more variables: `delta[4]` &lt;dbl&gt;, `beta[1]` &lt;dbl&gt;, `beta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,1]` &lt;dbl&gt;, `sigma[2,1]` &lt;dbl&gt;, `sigma[3,1]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,2]` &lt;dbl&gt;, `sigma[2,2]` &lt;dbl&gt;, `sigma[3,2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,3]` &lt;dbl&gt;, `sigma[2,3]` &lt;dbl&gt;, `sigma[3,3]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,4]` &lt;dbl&gt;, `sigma[2,4]` &lt;dbl&gt;, `sigma[3,4]` &lt;dbl&gt;, lp__ &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   .chain &lt;int&gt;, .iteration &lt;int&gt;, .draw &lt;int&gt;, …</span></span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_independent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbl_mcmc_independent.html">hbl_mcmc_independent</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  rep <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  rep_reference <span class="op">=</span> <span class="st">"visit1"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Raise these arguments for serious analyses:</span></span>
<span>  chains <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Increase to about 3 or 4 in real-life use cases.</span></span>
<span>  iter <span class="op">=</span> <span class="fl">400</span>, <span class="co"># Increase to several thousand in real-life use cases.</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">200</span>, <span class="co"># Increase to several thousand in real-life use cases.</span></span>
<span>  cores <span class="op">=</span> <span class="fl">1</span> <span class="co"># Optionally run different chains in different processes.</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'historicalborrowlong' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 6.6e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.66 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 400 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  40 / 400 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  80 / 400 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 120 / 400 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 160 / 400 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 400 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 201 / 400 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 240 / 400 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 280 / 400 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 320 / 400 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 360 / 400 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 400 / 400 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 1.964 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                0.897 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                2.861 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1:</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_independent</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 200 × 61</span></span></span>
<span><span class="co">#&gt;    `alpha[1]` `alpha[2]` `alpha[3]` `alpha[4]` `alpha[5]` `alpha[6]` `alpha[7]`</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1.71       1.06       0.931      0.693     0.112       0.973      0.903</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1.17       0.770      0.942      0.593     0.804       0.979      1.23 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      1.55       1.05       0.916      0.963     0.673       0.985      1.35 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1.27       0.524      0.998      0.599     0.344       0.993      1.35 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      1.43       1.01       1.02       0.691     0.569       0.991      1.38 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      1.25       1.03       0.910      1.03      0.629       0.983      1.16 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      1.18       0.996      0.991      0.267     0.346       0.983      1.15 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      1.02       0.929      1.06       0.772     0.481       0.985      1.37 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      1.07       1.10       0.979      0.645     0.252       0.992      1.44 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      0.837      1.16       0.918      0.745    -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">3</span>      0.987      1.66 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 190 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 54 more variables: `alpha[8]` &lt;dbl&gt;, `alpha[9]` &lt;dbl&gt;, `alpha[10]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `alpha[11]` &lt;dbl&gt;, `alpha[12]` &lt;dbl&gt;, `delta[1]` &lt;dbl&gt;, `delta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `delta[3]` &lt;dbl&gt;, `delta[4]` &lt;dbl&gt;, `beta[1]` &lt;dbl&gt;, `beta[2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,1]` &lt;dbl&gt;, `sigma[2,1]` &lt;dbl&gt;, `sigma[3,1]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,2]` &lt;dbl&gt;, `sigma[2,2]` &lt;dbl&gt;, `sigma[3,2]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `sigma[1,3]` &lt;dbl&gt;, `sigma[2,3]` &lt;dbl&gt;, `sigma[3,3]` &lt;dbl&gt;, …</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="model-performance">Model performance<a class="anchor" aria-label="anchor" href="#model-performance"></a>
</h2>
<p>A typical workflow will run all three models. Since each model can
take several hours to run, it is strongly recommended to:</p>
<ol style="list-style-type: decimal">
<li>For each model, run all chains in parallel by setting the
<code>cores</code> argument equal to <code>chains</code>.</li>
<li>Run all models concurrently on different jobs on a computing
cluster. Since <code>cores</code> will usually be greater than 1, it is
strongly recommended that each cluster job have as many cores/slots as
the <code>cores</code> argument.</li>
</ol>
</div>
<div class="section level2">
<h2 id="convergence">Convergence<a class="anchor" aria-label="anchor" href="#convergence"></a>
</h2>
<p>It is important to check convergence diagnostics on each model. The
<code><a href="../reference/hbl_convergence.html">hbl_convergence()</a></code> function returns data frame of summarized
convergence diagnostics. <code>max_rhat</code> is the maximum univariate
Gelman/Rubin potential scale reduction factor over all the parameters of
the model, <code>min_ess_bulk</code> is the minimum bulk effective
sample size over the parameters, and <code>min_ess_tail</code> is the
minimum tail effective sample size. <code>max_rhat</code> should be
below 1.01, and the ESS metrics should both be above 100 times the
number of MCMC chains. If any of these conditions are not true, the MCMC
did not converge, and it is recommended to try running the model for
more saved iterations (and if <code>max_rhat</code> is high, possibly
more warmup iterations). You could also try increasing
<code>adapt_delta</code> and <code>max_treedepth</code> in the
<code>control</code> argument, or adjust other MCMC/HMC settings through
<code>control</code> or the informal arguments (ellipsis
“<code>...</code>”). See <code><a href="https://mc-stan.org/rstan/reference/stan.html" class="external-link">?rstan::stan</a></code> for details.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hbl_convergence.html">hbl_convergence</a></span><span class="op">(</span><span class="va">mcmc_hierarchical</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   max_rhat min_ess_bulk min_ess_tail</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1.11         8.53         11.9</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>Each model can be summarized with the <code><a href="../reference/hbl_summary.html">hbl_summary()</a></code>
function. The output is a table with few rows and many columns.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_hierarchical</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbl_summary.html">hbl_summary</a></span><span class="op">(</span></span>
<span>  mcmc <span class="op">=</span> <span class="va">mcmc_hierarchical</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  rep <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  rep_reference <span class="op">=</span> <span class="st">"visit1"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  eoi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"&gt;"</span>, <span class="st">"&lt;"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">summary_hierarchical</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 54</span></span></span>
<span><span class="co">#&gt;   group group_label   rep rep_label data_n data_N data_n_study_1 data_n_study_2</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 arm1            1 visit1        30     30             10             10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 arm1            2 visit2        30     30             10             10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1 arm1            3 visit3        30     30             10             10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1 arm1            4 visit4        30     30             10             10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     2 arm2            1 visit1        10     10              0              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     2 arm2            2 visit2        10     10              0              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>     2 arm2            3 visit3        10     10              0              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>     2 arm2            4 visit4        10     10              0              0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more variables: data_n_study_3 &lt;int&gt;, data_N_study_1 &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   data_N_study_2 &lt;int&gt;, data_N_study_3 &lt;int&gt;, data_mean &lt;dbl&gt;, data_sd &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   data_lower &lt;dbl&gt;, data_upper &lt;dbl&gt;, response_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   response_variance &lt;dbl&gt;, response_sd &lt;dbl&gt;, response_lower &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   response_upper &lt;dbl&gt;, response_mean_mcse &lt;dbl&gt;, response_sd_mcse &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   response_lower_mcse &lt;dbl&gt;, response_upper_mcse &lt;dbl&gt;, change_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   change_lower &lt;dbl&gt;, change_upper &lt;dbl&gt;, change_mean_mcse &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p><code><a href="../reference/hbl_summary.html">hbl_summary()</a></code> returns a tidy data frame with one row per
group (e.g. treatment arm) and the columns in the following list. Unless
otherwise specified, the quantities are calculated at the group-by-rep
level. Some are calculated for the current (non-historical) study only,
while others pertain to the combined dataset which includes all
historical studies.</p>
<ul>
<li>
<code>group</code>: group index.</li>
<li>
<code>group_label</code>: original group label in the data.</li>
<li>
<code>rep</code>: rep index.</li>
<li>
<code>rep_label</code>: original rep label in the data.</li>
<li>
<code>data_mean</code>: observed mean of the response specific to
the current study.</li>
<li>
<code>data_sd</code>: observed standard deviation of the response
specific to the current study.</li>
<li>
<code>data_lower</code>: lower bound of a simple frequentist 95%
confidence interval of the observed data mean specific to the current
study.</li>
<li>
<code>data_upper</code>: upper bound of a simple frequentist 95%
confidence interval of the observed data mean specific to the current
study.</li>
<li>
<code>data_n</code>: number of non-missing observations in the
combined dataset (all studies).</li>
<li>
<code>data_N</code>: total number of observations (missing and
non-missing) in the combined dataset (all studies).</li>
<li>
<code>data_n_study_*</code>: number of non-missing observations in
each study. The suffixes of these column names are integer study
indexes. Call
<code>dplyr::distinct(hbl_data(your_data), study, study_label)</code> to
see which study labels correspond to these integer indexes.</li>
<li>
<code>data_N_study_*</code>: total number of observations (missing
and non-missing) within each study. The suffixes of these column names
are integer study indexes. Call
<code>dplyr::distinct(hbl_data(your_data), study, study_label)</code> to
see which study labels correspond to these integer indexes.</li>
<li>
<code>response_mean</code>: Estimated posterior mean of the response
from the model. (Here, the response variable in the data should be a
change from baseline outcome.) Specific to the current study.</li>
<li>
<code>response_sd</code>: Estimated posterior standard deviation of
the mean response from the model. Specific to the current study.</li>
<li>
<code>response_variance</code>: Estimated posterior variance of the
mean response from the model. Specific to the current study.</li>
<li>
<code>response_lower</code>: Lower bound of a 95% posterior interval
on the mean response from the model. Specific to the current study.</li>
<li>
<code>response_upper</code>: Upper bound of a 95% posterior interval
on the mean response from the model. Specific to the current study.</li>
<li>
<code>response_mean_mcse</code>: Monte Carlo standard error of
<code>response_mean</code>.</li>
<li>
<code>response_sd_mcse</code>: Monte Carlo standard error of
<code>response_sd</code>.</li>
<li>
<code>response_lower_mcse</code>: Monte Carlo standard error of
<code>response_lower</code>.</li>
<li>
<code>response_upper_mcse</code>: Monte Carlo standard error of
<code>response_upper</code>.</li>
<li>
<code>change_*</code>: same as the <code>response_*</code> columns,
but for change from baseline instead of the response. Not included if
<code>response_type</code> is <code>"change"</code> because in that case
the response is already change from baseline. Specific to the current
study.</li>
<li>
<code>change_percent_*</code>: same as the <code>change_*</code>
columns, but for the <em>percent</em> change from baseline (from 0% to
100%). Not included if <code>response_type</code> is
<code>"change"</code> because in that case the response is already
change from baseline. Specific to the current study.</li>
<li>
<code>diff_*</code>: same as the <code>response_*</code> columns,
but for treatment effect.</li>
<li>
<code>P(diff &gt; EOI)</code>, <code>P(diff &lt; EOI)</code>: CSF
probabilities on the treatment effect specified with the
<code>eoi</code> and <code>direction</code> arguments. Specific to the
current study.</li>
<li>
<code>effect_mean</code>: same as the <code>response_*</code>
columns, but for the effect size (diff / residual standard deviation).
Specific to the current study.</li>
<li>
<code>precision_ratio*</code>: same as the <code>response_*</code>
columns, but for the precision ratio, which compares within-study
variance to among-study variance. Only returned for the hierarchical
model. Specific to the current study.</li>
</ul>
<div class="section level3">
<h3 id="borrowing-metrics">Borrowing metrics<a class="anchor" aria-label="anchor" href="#borrowing-metrics"></a>
</h3>
<p>The <code><a href="../reference/hbl_metrics.html">hbl_metrics()</a></code> function shows borrowing metrics like
the mean shift ratio and variance shift ratio which require input from
benchmark models. The mean shift ratio and variance shift ratio are
defined in the methods vignette. Below, we compute these metrics on the
hierarchical model.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_pool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbl_summary.html">hbl_summary</a></span><span class="op">(</span></span>
<span>  mcmc <span class="op">=</span> <span class="va">mcmc_pool</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  rep <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  rep_reference <span class="op">=</span> <span class="st">"visit1"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_independent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hbl_summary.html">hbl_summary</a></span><span class="op">(</span></span>
<span>  mcmc <span class="op">=</span> <span class="va">mcmc_independent</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  rep <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  rep_reference <span class="op">=</span> <span class="st">"visit1"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/hbl_metrics.html">hbl_metrics</a></span><span class="op">(</span></span>
<span>  borrow <span class="op">=</span> <span class="va">summary_hierarchical</span>,</span>
<span>  pool <span class="op">=</span> <span class="va">summary_pool</span>,</span>
<span>  independent <span class="op">=</span> <span class="va">summary_independent</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;     rep rep_label mean_shift_ratio variance_shift_ratio</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 visit1               1.70                 0.719</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2 visit2               0.629                0.665</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3 visit3              43.2                  0.726</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4 visit4               0.567                0.676</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<p>The <code><a href="../reference/hbl_plot_borrow.html">hbl_plot_borrow()</a></code> function visualizes the results
from the hierarchical model against the benchmark models (independent
and pooled) to gain intuition about the overall effect of borrowing on
estimation.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hbl_plot_borrow.html">hbl_plot_borrow</a></span><span class="op">(</span></span>
<span>  borrow <span class="op">=</span> <span class="va">summary_hierarchical</span>,</span>
<span>  pool <span class="op">=</span> <span class="va">summary_pool</span>,</span>
<span>  independent <span class="op">=</span> <span class="va">summary_independent</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<p><code><a href="../reference/hbl_plot_group.html">hbl_plot_group()</a></code> shows the same information but grouped
by the group designations in the data (e.g. treatment arm). The results
below are not actually correct because the MCMCs ran for so few
iterations. For serious analyses, increase the <code>iter</code> and
<code>warmup</code> arguments to several thousand and increase the
number of chains to about 3 or 4.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hbl_plot_group.html">hbl_plot_group</a></span><span class="op">(</span></span>
<span>  borrow <span class="op">=</span> <span class="va">summary_hierarchical</span>,</span>
<span>  pool <span class="op">=</span> <span class="va">summary_pool</span>,</span>
<span>  independent <span class="op">=</span> <span class="va">summary_independent</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p>For the hierarchical model, we can plot the marginal posterior of the
<span class="math inline">\(\tau\)</span> parameter to see the influence
of the uniform prior upper bound. If the probability mass of <span class="math inline">\(\tau\)</span> builds up against the uniform upper
bound, then the estimated hierarchical variance may be larger than
assumed, and should indicate that the algorithm wants to borrow less. If
the probability mass of <span class="math inline">\(\tau\)</span> is
concentrated on the left, towards 0, then this may indicate that the
data suggests borrowing and the uniform prior upper bound has little
effect on the model estimates.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hbl_plot_tau.html">hbl_plot_tau</a></span><span class="op">(</span><span class="va">mcmc_hierarchical</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="ongoing-problems-with-borrowing-metrics">Ongoing problems with borrowing metrics<a class="anchor" aria-label="anchor" href="#ongoing-problems-with-borrowing-metrics"></a>
</h3>
<p>For some analyses, the mean shift ratio can fall below 0 or above 1.
This may occur if pooled model estimates are very close to independent
model estimates for some time points, or when the uniform upper bound
prior is set to an uninformative large value and pooled model estimates
are very far away from independent model estimates, due to random
variability in the estimates of the independent, pooled, and
hierarchical model estimates. Mean shift ratio issues may also occur
when enforcing nontrivial correlation structures among time points
because of differences in longitudinal smoothing behavior among models.
(In the latter case, specifying diagonal covariance matrices may resolve
the issues.)</p>
<p>Similar issues with the variance shift ratio may occur for time
points where the pooled model estimate is far away from the independent
model, since large shifts in the mean may increase the magnitude of the
estimate of residual error for the current study.</p>
<p>The precision ratio metric is based on the conditional estimation of
treatment effect, rather than the unconditional estimation, so it will
usually be an underestimate of the mean shift ratio or the variance
shift ratio. (One benefit of unconditional estimation over conditional
estimation is reduced variability in the estimate of treatment
effect.)</p>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>It is almost always best to set a diffuse prior on <span class="math inline">\(\tau_t\)</span> so that historical borrowing is
fully dynamic. But in extreme cases with small numbers of historical
studies, it may be necessary to choose a value of <code>s_tau</code> to
approximate the prior amount of borrowing given a desired precision
ratio and supposed residual variance. See the function
<code><a href="../reference/hbl_s_tau.html">hbl_s_tau()</a></code> to suggest a rough value to begin exploring.
For a large number of historical studies, the computation may take an
extremely long time to run. It may be necessary to change arguments
<code>covariance_current</code> and <code>covariance_historical</code>
(especially the latter) for computational efficiency, but not even that
may be enough if the data is enormous.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by William Michael Landau.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
