<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Effective sample size (ESS) — hbl_ess • historicalborrowlong</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Effective sample size (ESS) — hbl_ess"><meta property="og:description" content="Quantify borrowing with effective sample size (ESS)
as cited and explained in the methods vignette at
https://wlandau.github.io/historicalborrowlong/articles/methods.html."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">historicalborrowlong</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/methods.html">Methods</a>
    </li>
    <li>
      <a href="../articles/usage.html">Usage</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/wlandau/historicalborrowlong/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Effective sample size (ESS)</h1>
    <small class="dont-index">Source: <a href="https://github.com/wlandau/historicalborrowlong/blob/main/R/hbl_ess.R" class="external-link"><code>R/hbl_ess.R</code></a></small>
    <div class="hidden name"><code>hbl_ess.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Quantify borrowing with effective sample size (ESS)
as cited and explained in the methods vignette at
<a href="https://wlandau.github.io/historicalborrowlong/articles/methods.html" class="external-link">https://wlandau.github.io/historicalborrowlong/articles/methods.html</a>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hbl_ess</span><span class="op">(</span></span>
<span>  <span class="va">mcmc_pool</span>,</span>
<span>  <span class="va">mcmc_hierarchical</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"study"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">study</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">group</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"patient"</span>,</span>
<span>  rep <span class="op">=</span> <span class="st">"rep"</span>,</span>
<span>  rep_reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">rep</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-mcmc-pool">mcmc_pool<a class="anchor" aria-label="anchor" href="#arg-mcmc-pool"></a></dt>
<dd><p>A fitted model from <code><a href="hbl_mcmc_pool.html">hbl_mcmc_pool()</a></code>.</p></dd>


<dt id="arg-mcmc-hierarchical">mcmc_hierarchical<a class="anchor" aria-label="anchor" href="#arg-mcmc-hierarchical"></a></dt>
<dd><p>A fitted model from <code><a href="hbl_mcmc_hierarchical.html">hbl_mcmc_hierarchical()</a></code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A tidy data frame or <code>tibble</code> with the data.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p></dd>


<dt id="arg-study">study<a class="anchor" aria-label="anchor" href="#arg-study"></a></dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p></dd>


<dt id="arg-study-reference">study_reference<a class="anchor" aria-label="anchor" href="#arg-study-reference"></a></dt>
<dd><p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p></dd>


<dt id="arg-group-reference">group_reference<a class="anchor" aria-label="anchor" href="#arg-group-reference"></a></dt>
<dd><p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p></dd>


<dt id="arg-patient">patient<a class="anchor" aria-label="anchor" href="#arg-patient"></a></dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p></dd>


<dt id="arg-rep">rep<a class="anchor" aria-label="anchor" href="#arg-rep"></a></dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the rep ID.</p></dd>


<dt id="arg-rep-reference">rep_reference<a class="anchor" aria-label="anchor" href="#arg-rep-reference"></a></dt>
<dd><p>Atomic of length 1,
element of the <code>rep</code> column that indicates
baseline, i.e. the first rep chronologically.
(The other reps may be post-baseline study visits or time points.)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame with one row per discrete time point ("rep")
and the following columns:</p><ul><li><p><code>v0</code>: posterior predictive variance of the control group mean of a
hypothetical new study given the pooled model.
Calculated as the mean over MCMC samples of <code>1 / sum(sigma_i ^ 2)</code>,
where each <code>sigma_i</code> is the residual standard deviation of
study <code>i</code> estimated from the pooled model.</p></li>
<li><p><code>v_tau</code>: posterior predictive variance of a hypothetical
new control group mean under the hierarchical model.
Calculated by averaging over predictive draws,
where each predictive draw is from
<code>rnorm(n = 1, mean = mu_, sd = tau_)</code> and <code>mu_</code> and <code>tau_</code> are the
<code>mu</code> and <code>tau</code> components of an MCMC sample.</p></li>
<li><p><code>n</code>: number of non-missing historical control patients.</p></li>
<li><p><code>weight</code>: strength of borrowing as a ratio of variances: <code>v0 / v_tau</code>.</p></li>
<li><p><code>ess</code>: strength of borrowing as a prior effective sample size:
<code>n v0 / v_tau</code>, where <code>n</code> is the number of non-missing historical
control patients.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other summary:
<code><a href="hbl_summary.html">hbl_summary</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="hbl_sim_independent.html">hbl_sim_independent</a></span><span class="op">(</span>n_continuous <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"group%s"</span>, <span class="va">data</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="va">study</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"study%s"</span>, <span class="va">data</span><span class="op">$</span><span class="va">study</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">$</span><span class="va">rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"rep%s"</span>, <span class="va">data</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="va">pool</span> <span class="op">&lt;-</span> <span class="fu"><a href="hbl_mcmc_pool.html">hbl_mcmc_pool</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="va">data</span>,</span></span>
<span class="r-in"><span>        chains <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        warmup <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>        iter <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>        seed <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="va">hierarchical</span> <span class="op">&lt;-</span> <span class="fu"><a href="hbl_mcmc_hierarchical.html">hbl_mcmc_hierarchical</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="va">data</span>,</span></span>
<span class="r-in"><span>        chains <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        warmup <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>        iter <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>        seed <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">hbl_ess</span><span class="op">(</span></span></span>
<span class="r-in"><span>    mcmc_pool <span class="op">=</span> <span class="va">pool</span>,</span></span>
<span class="r-in"><span>    mcmc_hierarchical <span class="op">=</span> <span class="va">hierarchical</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">data</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   rep [4]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rep rep_label     n    v0 v_tau weight   ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 rep1        400 6.32  0.446 14.2   <span style="text-decoration: underline;">5</span>667.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     2 rep2        400 6.06  0.745  8.13  <span style="text-decoration: underline;">3</span>253.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 rep3        400 6.20  0.900  6.89  <span style="text-decoration: underline;">2</span>758.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     4 rep4        400 0.354 0.635  0.558  223.</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by William Michael Landau.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

